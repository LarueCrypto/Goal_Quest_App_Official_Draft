import streamlit as st
from anthropic import Anthropic

# Access the secret
client = Anthropic(api_key=st.secrets["ANTHROPIC_API_KEY"])

st.title("Claude Chatbot")

if "messages" not in st.session_state:
    st.session_state.messages = []

# Basic Chat Implementation
if prompt := st.chat_input("How can I help?"):
    st.session_state.messages.append({"role": "user", "content": prompt})
    
    with st.chat_message("assistant"):
        response = client.messages.create(
            model="claude-3-5-sonnet-20240620",
            max_tokens=1024,
            messages=[{"role": m["role"], "content": m["content"]} for m in st.session_state.messages]
        )
        st.write(response.content[0].text)
        st.session_state.messages.append({"role": "assistant", "content": response.content[0].text})
